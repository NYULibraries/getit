# Configure what service plugins are used by Umlaut. This skeleton file
# has been generated into your app to help you get started. 
#
# If a service has "disabled:true", it's currently turned off. 
#
# Some services require local api key or connection details as config.
# Most services take other options for custom configuration too, not
# all options are neccesarily listed as examples here, see source
# or source-generated docs for more info.   
default:
  views:
    css: search
    resolve_css: resolve
    sfx_base_url: http://sfx.library.nyu.edu/sfxlcl41?
  services:
    # Priority 2
    NYU_Primo:
      type: PrimoService
      priority: 2 # After SFX, to get SFX metadata enhancement
      base_url: http://bobcat.library.nyu.edu
      vid: NYU
      institution: NYU
      holding_search_institution: NYU
      holding_search_text: Search for this title in BobCat.
      suppress_holdings: [ !ruby/regexp '/\$\$LBWEB/', !ruby/regexp '/\$\$LNWEB/', !ruby/regexp '/\$\$LTWEB/', !ruby/regexp '/\$\$LWEB/', !ruby/regexp '/\$\$1Restricted Internet Resources/' ]
      ez_proxy: !ruby/regexp '/https\:\/\/ezproxy\.library\.nyu\.edu\/login\?url=/'
      service_types:
        - primo_source
        - holding_search
        - fulltext
        - table_of_contents
        - referent_enhance
        - cover_image

    # Priority 3
    # First half of Amazon, run in foreground, get metadata and cover images.
    Amazon:
      display_name: Amazon.com
      type: Amazon
      url: http://webservices.amazon.com/onca/xml
      api_key: 1ZQ8VEWY2A7VSJ93CW82
      secret_key: jZNsa8uaOxo2mj1TvHQVDs464TcPEvuidSF/xepO
      associate_tag: nyli0a-20
      priority: 3
      service_types:
        - referent_enhance
        - cover_image

    # Priority 4
    # Wayfinder to return whence you came
    Wayfinder:
      name: NYU Wayfinder
      type: Wayfinder
      priority: 4
      known_rfrs:
        -
          name: primo 
          regex: !ruby/regexp '/info:sid\/primo\.exlibrisgroup\.com:primo-(.+)/'
          base_url: http://library.nyu.edu/persistent/lcn/
          display_text: Back to BobCat
        -
          name: xerxes
          regex: !ruby/regexp '/info:sid\/library\.nyu\.edu:xerxes \((.+)\)/'
          base_url: "https://arch.library.nyu.edu/databases/alphabetical?base=databases&action=find&query="
          display_text: Back to database search
        -
          name: umlaut
          regex: !ruby/regexp '/info:sid\/sfxit\.com:citation/'
          base_url: "https://getit.library.nyu.edu"
          display_text: Back to e-journal search
        -
          name: worldcat1
          regex: !ruby/regexp '/info:sid\/firstsearch\.oclc\.org:WorldCat/'
          base_url: "http://www.worldcat.org"
          display_text: Back to WorldCat
        -
          name: worldcat2
          regex: !ruby/regexp '/info:sid\/FirstSearch:WorldCat/'
          base_url: "http://www.worldcat.org/search?qt=worldcat_org_all"
          display_text: Back to WorldCat
          querystring_metadata:
            q: title

    # Priority a: Background
    NYU_Primo_Source:
      type: PrimoSource
      priority: a
      base_url: http://bobcat.library.nyu.edu
      vid: NYU
      source_attributes:
        - request_link_supports_ajax_call

    # Priority c: Background          
    # Second half of Amazon. It's Slow to lookup highlighted_link and search_inside
    # availability, so we do it in a bg wave.  
    Amazon_bg:
      type: Amazon
      api_key: 1ZQ8VEWY2A7VSJ93CW82
      secret_key: jZNsa8uaOxo2mj1TvHQVDs464TcPEvuidSF/xepO
      associate_tag: nyli0a-20
      priority: c        
      service_types:
        - abstract
        - highlighted_link
        - search_inside
        - excerpts
    
    CoverThing:
      type: CoverThing
      developer_key: 0db3ae0934bc35aed93ea676c883128c
      priority: c
      # Pre-empted by says if we already have a cover_image response
      # from somewhere else that runs earlier, don't run this. 
      preempted_by:
        existing_type: cover_image
        
    ElsevierCover:
      type: ElsevierCover
      priority: c
      
    UlrichsCover:
      type: UlrichsCover
      priority: c      
        
    GoogleBookSearch:
      type: GoogleBookSearch
      priority: c        
      api_key: AIzaSyADjP7PRPsGaPYJB9tvfm8ZSpdmhUsCR1w
              
    IsbnDb:
      display_name: isbndb.com
      type: IsbnDb
      priority: c
      access_key: 9FAOAU2Z
      
    InternetArchive:
      display_name: the Internet Archive
      type: InternetArchive
      priority: c
      # disable audio results? uncomment:
      #num_results_for_types:
      #  audio: 0

    # Web of Knowledge API has no api key, but your
    # IP needs to be registered with them. See source docs
    # for how. 
    IsiCitations:
      type: Isi
      priority: c

    # Thomson JCR LAMR api has no api key, but your
    # IP needs to be registered with them. Same registraiton
    # as for ISI WoK generally. 
    Jcr:
      type: Jcr
      priority: c

    # Priority d
    HathiTrust:
      type: HathiTrust
      priority: d
      # Uncomment to link through this 'internal' URL instead
      # of following permalinks. jrochkind does this to use
      # a WAYFless shibboleth login with EZProxy. 
      #direct_link_base: 'https://babel.hathitrust.org/shcgi/'
      #
      # This next says:
      # Don't add HathiTrust fulltext if there's already a
      # GoogleBookSearch fulltext. Still add other HT response
      # types. 
      # preempted_by:
      #   self_type: fulltext
      #   existing_service: GoogleBookSearch
      #   existing_type: fulltext

    # Worldcat scraper can be quite slow, move it to wave 'd' to avoid
    # holding up wave 'c'
    Worldcat:
      display_name: OCLC Worldcat.org
      type: Worldcat
      priority: d
      # suppress_precheck says don't actually screen-scrape to
      # see if the link is good, just link blindly. Mostly works
      # for WorldCat, avoids the performance hit. 
      suppress_precheck: true

    WorldcatIdentities:
      type: WorldcatIdentities
      priority: d
      # Turn off certain response types:
      #note_types: false
      #wikipedia_link: false
      #openurl_widely_held: false
      #require_identifier: true

    # GPO is kind of experimental, it doesn't work great, but IF an 
    # OpenURL includes a sudoc call number or other GPO identifiers,
    # will try to link to full text via GPO catalog scrape. 
    Gpo:
      type: Gpo
      disabled: true
      priority: e
      #preempted_by:
      #  - existing_type: fulltext
      #  - existing_type: fulltext_title_level

    ####
    # Link out filters: Effect what happens when a user clicks
    # on an Umlaut link to a third party source. Link out filters
    # can operate to change where link goes or execute side effects
    # on click. 
    ####

    # Redirect outgoing links through EZProxy                
    EZProxy:
      type: Ezproxy
      disabled: true
      task: link_out_filter  
      proxy_server:  HOSTNAME_OF_YOUR_EZPROXY
      # By default, will pre-check with EZProxy api and
      # only send links through EZProxy that are proxyable.
      # requires proxy_password to be set. 
      # optionally, set precheck_with_api false, and the EZProxy
      # api won't be used, ALL links go through EZProxy. You may
      # have EZProxy itself set to transparently redirect non-proxyable
      # URLs back to non-proxied version.
      #
      #precheck_with_api: false
      priority: 5
      proxy_password: YOUR_EZPROXY_API_PWD
      # Want to exclude certain hostnames from being directed through EZProxy?
      # list them in array here:
      #exclude: [ host.unversity.edu, otherhost.somewhere.com]
      
    # Use of SFX api means that SFX can no longer keep statistics on
    # clickthroughs. This link out filter will attempt to fake SFX into
    # thinking a direct click happened when user clicks on an SFX link
    # via Umlaut.  This is VERY fragile logic, required reverse engineering
    # SFX and faking it out, still doesn't work all the time. But works
    # much of the time. 
    SFX_backchannel_record:
      type: SfxBackchannelRecord
      disabled: true
      priority: 6

    # Exports
    EmailExport:
      type: EmailExport
      priority: d

    TxtHoldingExport:
      type: TxtHoldingExport
      priority: e

NYU:
  name: NYU Libraries
  parent_code: default
  active_tab: journals
  views:
    css: search
    resolve_css: resolve
  ip_addresses:
    - 128.122.0.0-128.122.149.239
    - 172.26.*.*
    - 172.27.*.*
    - 172.22.88.*
    - 216.165.*.*
    - 128.238.*.*
  services:
    NYU_SFX:
      name: Get It @ NYU
      display_name: Get It @ NYU
      type: Sfx
      base_url: http://sfx.library.nyu.edu/sfxlcl41
      priority: 1
      click_passthrough: false
      sfx_requests_expire_crontab: '00 00 * * 00' 
      sfx_timeout: 9
      extra_targets_of_interest:
        # ISI_RESEARCHSOFT_EXPORT_TOOL: export_citation
        # REFWORKS_EXPORT_TOOL: export_citation
        ASK_A_LIBRARIAN_LCL: help
        COMMENTS_ABOUT_BOBCAT_LCL: help
    NYUUlrichsLink:
      type: UlrichsLink
      display_name: Ulrich's Directory
      link_name: Periodical Information
      priority: c
      status: active
      base_url: https://ezproxy.library.nyu.edu/login?url=http://www.ulrichsweb.com/ulrichsweb/Search/call_fullCitation.asp?/vendor_redirect.asp?oVendor=Umlaut&oIssn=
    ScopusCitations:
      type: Scopus
      priority: c
      json_api_key: yI7GR2aKR1n9ZvMd36rrd1zASdGJYJ
      # partner_id: YOUR_SCOPUS_PARTNER_ID
      # link_salt_key: "YOUR_SCOPUS_LINK_SALT_KEY"
    NYU_RefWorks:
      name: RefWorks
      type: OpenURLService
      base_url: http://webdev2.bobst.nyu.edu:8080/citation/cite?to_format=refworks&
      display_text: Push to RefWorks
      priority: 3
      service_types:
          - export_citation
    NYU_Endnote:
      name: EndNoteWeb
      type: OpenURLService
      base_url: http://webdev2.bobst.nyu.edu:8080/citation/cite?to_format=endnote&
      display_text: Push to EndNote Web
      priority: 4
      service_types:
          - export_citation
    NYU_EASYBIB:
      name: EasyBib
      type: OpenURLService
      base_url: http://webdev2.bobst.nyu.edu:8080/citation/cite?to_format=pusheasybib&
      display_text: Push to EasyBib
      priority: 5
      service_types:
          - export_citation
    NYU_RIS:
      name: RIS
      type: OpenURLService
      base_url: http://webdev2.bobst.nyu.edu:8080/citation/cite?to_format=ris&
      display_text: Download as RIS
      priority: 6
      service_types:
          - export_citation
    NYU_BIBTEX:
      name: BibTeX
      type: OpenURLService
      base_url: http://webdev2.bobst.nyu.edu:8080/citation/cite?to_format=bibtex&
      display_text: Download as BibTeX
      priority: 7
      service_types:
          - export_citation
NYUAD:
  name: NYU Abu Dhabi Library
  parent_code: NYU 
  views:
    css: search_nyuad
    resolve_css: resolve_nyuad
    wayfinder_attributes:
      primo:
        url_suffix: "?institution=nyuad"
      xerxes: 
        url_suffix: "&institution=nyuad"
      umlaut: 
        url_suffix: "/nyuad"
  ip_addresses:
    - 192.168.224.0/23
    - 192.168.226.0/24
    - 192.168.227.0/25
    - 192.168.227.128/26
    - 172.25.79.0/26
    - 172.26.240.0/22
    - 172.30.60.0/24
    - 172.27.240.0/22
    - 172.29.252.0/24
    - 172.29.120.0/23
    - 192.168.192.0/23
    - 192.168.195.0/25
    - 172.25.76.0/23
    - 172.26.232.0/22
    - 172.30.58.0/24
    - 172.27.232.0/22
    - 172.29.250.0/24
    - 172.29.116.0/23
    - 192.168.194.0/24
    - 172.25.78.0/26
    - 172.26.236.0/22
    - 172.30.59.0/24
    - 172.27.236.0/22
    - 172.29.251.0/24
    - 172.29.118.0/23

CU:
  name: The Cooper Union Library
  active_tab: journals
  views:
    css: search_cu
    resolve_css: resolve_cu
    sfx_base_url: http://sfx.library.nyu.edu/sfxcooper?
    wayfinder_attributes:
        primo:
          url_suffix: "?institution=cu" 
        xerxes: 
          url_suffix: "&institution=cu"
        umlaut: 
          url_suffix: "/cu"
  controllers:
    searcher: Sfx4Solr::Cu
    # searcher: Sfx4Cu
  ip_addresses:
    - 199.98.16.0-199.98.31.255 
  services:
    # CU SFX service.
    CU_SFX:
      name: Get It @ Cooper Union
      display_name: Get It @ Cooper Union
      type: Sfx
      base_url: http://sfx.library.nyu.edu/sfxcooper
      priority: 1
      click_passthrough: false
      sfx_requests_expire_crontab: '00 00 * * 00' 
      sfx_timeout: 9
      extra_targets_of_interest:
          CAPTURE_CITATION: export_citation
    ScopusCitations:
      type: Scopus
      priority: c
      json_api_key: yI7GR2aKR1n9ZvMd36rrd1zASdGJYJ
      # partner_id: YOUR_SCOPUS_PARTNER_ID
      # link_salt_key: "YOUR_SCOPUS_LINK_SALT_KEY"

NS:
  name: New School Libraries
  active_tab: journals
  views:
    css: search_ns
    resolve_css: resolve_ns
    sfx_base_url: http://sfx4.library.newschool.edu/ns?
    wayfinder_attributes:
        primo:
          url_suffix: "?institution=ns" 
        xerxes: 
          url_suffix: "&institution=ns"
        umlaut: 
          url_suffix: "/ns"
  controllers:
    searcher: Sfx4Solr::Ns
    # searcher: Sfx4Ns
  ip_addresses:
    - 149.31.0.0-149.31.255.255
    - 69.64.210.46
    - 69.64.210.50
    - 69.64.210.42
    - 69.193.198.126
  services:
    NS_SFX:
      name: Get It @ New School Libraries
      display_name: Get It @ New School Libraries
      type: Sfx
      base_url: http://sfx4.library.newschool.edu/ns
      priority: 1
      click_passthrough: true
      sfx_requests_expire_crontab: '00 00 * * 00' 
      sfx_timeout: 9
      extra_targets_of_interest:
        ISI_RESEARCHSOFT_EXPORT_TOOL: export_citation
        REFWORKS_EXPORT_TOOL: export_citation
        # ISI_WEB_OF_SCIENCE: export_citation
        BX_RECOMMENDER_SERVICE: help
        ASK_A_LIBRARIAN_LCL: help
        COMMENTS_ABOUT_BOBCAT_LCL: help
    NS_bX:
      type: Bx
      display_name: Recommender Services
      priority: c
      token: 684258fc2121c50ffbf2e12ae2e41d2a
      openurl_base: /getit/resolve?umlaut.institution=NS&
      max_records: 2
    NYUOpenURL:
      name: BobCat
      type: OpenURLService
      display_name: BobCat
      display_text: GetIt @ NYU
      base_url: http://getit.library.nyu.edu/nyu/resolve?
      priority: c
      status: active
    NSUlrichsLink:
      type: UlrichsLink
      display_name: Ulrich's Directory
      link_name: Periodical Information
      priority: c
      status: active
      base_url: https://login.libproxy.newschool.edu/login?url=http://www.ulrichsweb.com/ulrichsweb/Search/call_fullCitation.asp?/vendor_redirect.asp?oVendor=Umlaut&oIssn=

NYSID:
  display_name: New York School of Interior Design Library
  views:
    css: search
    resolve_css: resolve
  ip_addresses:
    - 128.122.0.1

HSL:
  active_tab: journals
  views:
    css: search_hsl
    resolve_css: resolve_hsl
  ip_addresses:
    - 128.122.0.1
  services:
    HSL_SFX:
      name: Get It @ NYU Health Sciences Libraries
      display_name: Get It @ NYU Health Sciences Libraries
      type: Sfx
      base_url: http://sfx.med.nyu.edu/sfxlcl3
      priority: 1
      click_passthrough: true
      sfx_requests_expire_crontab: '00 00 * * 00' 
      sfx_timeout: 9
